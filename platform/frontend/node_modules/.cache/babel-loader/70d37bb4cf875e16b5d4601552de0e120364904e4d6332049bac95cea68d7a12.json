{"ast":null,"code":"import React,{useState}from'react';import{useParams,Link}from'react-router-dom';import{useQuery}from'react-query';import{ArrowLeftIcon,UserIcon,KeyIcon,PlayIcon,StopIcon,TrashIcon,DocumentTextIcon,EyeIcon,EyeSlashIcon,ClipboardDocumentIcon,CheckCircleIcon,ClockIcon,XMarkIcon}from'@heroicons/react/24/outline';import{attendeeApi,deploymentApi}from'../services/api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const AttendeeView=()=>{const{id}=useParams();const[showCredentials,setShowCredentials]=useState(false);const[copiedField,setCopiedField]=useState(null);// Fetch attendee details\nconst{data:attendee,isLoading:attendeeLoading,error:attendeeError}=useQuery(['attendee',id],()=>attendeeApi.getAttendee(id),{enabled:!!id,refetchInterval:10000});// Fetch attendee credentials\nconst{data:credentials,isLoading:credentialsLoading}=useQuery(['attendee-credentials',id],()=>attendeeApi.getAttendeeCredentials(id),{enabled:!!id&&(attendee===null||attendee===void 0?void 0:attendee.status)==='active',refetchInterval:false});// Fetch deployment logs\nconst{data:deploymentLogs=[],isLoading:logsLoading}=useQuery(['deployment-logs',id],()=>deploymentApi.getAttendeeDeploymentLogs(id),{enabled:!!id,refetchInterval:30000});const copyToClipboard=async(text,field)=>{try{await navigator.clipboard.writeText(text);setCopiedField(field);setTimeout(()=>setCopiedField(null),2000);}catch(err){console.error('Failed to copy text: ',err);}};const getStatusIcon=status=>{switch(status){case'active':return/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-5 w-5 text-success-500\"});case'deploying':return/*#__PURE__*/_jsx(ClockIcon,{className:\"h-5 w-5 text-warning-500 animate-spin\"});case'failed':return/*#__PURE__*/_jsx(XMarkIcon,{className:\"h-5 w-5 text-danger-500\"});case'deleting':return/*#__PURE__*/_jsx(ClockIcon,{className:\"h-5 w-5 text-danger-500 animate-spin\"});default:return/*#__PURE__*/_jsx(ClockIcon,{className:\"h-5 w-5 text-gray-500\"});}};const getStatusClass=status=>{switch(status){case'active':return'status-active';case'deploying':return'status-deploying';case'failed':return'status-failed';case'deleting':return'status-deleting';default:return'status-planning';}};if(attendeeLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"animate-fade-in\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"animate-pulse space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-8 bg-gray-200 rounded w-1/3\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-32 bg-gray-200 rounded\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-64 bg-gray-200 rounded\"})]})]})});}if(attendeeError||!attendee){return/*#__PURE__*/_jsxs(\"div\",{className:\"animate-fade-in\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/workshops\",className:\"inline-flex items-center text-sm text-primary-600 hover:text-primary-500 mb-4\",children:[/*#__PURE__*/_jsx(ArrowLeftIcon,{className:\"h-4 w-4 mr-1\"}),\"Back to Workshops\"]}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"Attendee Not Found\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(XMarkIcon,{className:\"mx-auto h-12 w-12 text-danger-400\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"mt-2 text-sm font-medium text-gray-900\",children:\"Attendee not found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-gray-500\",children:\"The attendee you're looking for doesn't exist or has been deleted.\"})]})})})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"animate-fade-in\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsxs(Link,{to:`/workshops/${attendee.workshop_id}`,className:\"inline-flex items-center text-sm text-primary-600 hover:text-primary-500 mb-4\",children:[/*#__PURE__*/_jsx(ArrowLeftIcon,{className:\"h-4 w-4 mr-1\"}),\"Back to Workshop\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[getStatusIcon(attendee.status),/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:attendee.username}),/*#__PURE__*/_jsx(\"span\",{className:`${getStatusClass(attendee.status)} whitespace-nowrap flex-shrink-0`,children:attendee.status})]}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-gray-600\",children:attendee.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center gap-3 flex-shrink-0\",children:[(attendee.status==='planning'||attendee.status==='failed')&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>console.log('Deploy individual attendee'),className:\"btn-primary whitespace-nowrap\",children:[/*#__PURE__*/_jsx(PlayIcon,{className:\"h-4 w-4 mr-2\"}),\"Deploy Resources\"]}),attendee.status==='active'&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>console.log('Destroy individual attendee'),className:\"btn-danger whitespace-nowrap\",children:[/*#__PURE__*/_jsx(StopIcon,{className:\"h-4 w-4 mr-2\"}),\"Destroy Resources\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>console.log('Delete attendee'),className:\"btn-danger whitespace-nowrap\",children:[/*#__PURE__*/_jsx(TrashIcon,{className:\"h-4 w-4 mr-2\"}),\"Remove Attendee\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-medium text-gray-900 flex items-center\",children:[/*#__PURE__*/_jsx(UserIcon,{className:\"h-5 w-5 mr-2\"}),\"Attendee Information\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Username\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-gray-900\",children:attendee.username})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Email\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-gray-900\",children:attendee.email})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Status\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 flex items-center space-x-2\",children:[getStatusIcon(attendee.status),/*#__PURE__*/_jsx(\"span\",{className:getStatusClass(attendee.status),children:attendee.status})]})]}),attendee.ovh_project_id&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"OVH Project ID\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-gray-900 font-mono\",children:attendee.ovh_project_id})]})]})]}),attendee.status==='active'&&/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-medium text-gray-900 flex items-center\",children:[/*#__PURE__*/_jsx(KeyIcon,{className:\"h-5 w-5 mr-2\"}),\"Access Credentials\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCredentials(!showCredentials),className:\"text-sm text-primary-600 hover:text-primary-500 flex items-center\",children:showCredentials?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(EyeSlashIcon,{className:\"h-4 w-4 mr-1\"}),\"Hide\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(EyeIcon,{className:\"h-4 w-4 mr-1\"}),\"Show\"]})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:credentialsLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"animate-pulse space-y-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-gray-200 rounded w-1/4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-8 bg-gray-200 rounded\"})]}):credentials&&showCredentials?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Username\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"code\",{className:\"flex-1 px-3 py-2 bg-gray-50 border rounded text-sm font-mono\",children:credentials.username}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>copyToClipboard(credentials.username,'username'),className:\"p-2 text-gray-400 hover:text-gray-600\",children:copiedField==='username'?/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-4 w-4 text-success-500\"}):/*#__PURE__*/_jsx(ClipboardDocumentIcon,{className:\"h-4 w-4\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Password\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"code\",{className:\"flex-1 px-3 py-2 bg-gray-50 border rounded text-sm font-mono\",children:credentials.password}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>copyToClipboard(credentials.password,'password'),className:\"p-2 text-gray-400 hover:text-gray-600\",children:copiedField==='password'?/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-4 w-4 text-success-500\"}):/*#__PURE__*/_jsx(ClipboardDocumentIcon,{className:\"h-4 w-4\"})})]})]}),credentials.access_key&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Access Key\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"code\",{className:\"flex-1 px-3 py-2 bg-gray-50 border rounded text-sm font-mono\",children:credentials.access_key}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>copyToClipboard(credentials.access_key,'access_key'),className:\"p-2 text-gray-400 hover:text-gray-600\",children:copiedField==='access_key'?/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-4 w-4 text-success-500\"}):/*#__PURE__*/_jsx(ClipboardDocumentIcon,{className:\"h-4 w-4\"})})]})]}),credentials.secret_key&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Secret Key\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"code\",{className:\"flex-1 px-3 py-2 bg-gray-50 border rounded text-sm font-mono\",children:credentials.secret_key}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>copyToClipboard(credentials.secret_key,'secret_key'),className:\"p-2 text-gray-400 hover:text-gray-600\",children:copiedField==='secret_key'?/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-4 w-4 text-success-500\"}):/*#__PURE__*/_jsx(ClipboardDocumentIcon,{className:\"h-4 w-4\"})})]})]})]}):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:attendee.status==='active'?'Click \"Show\" to view credentials':'Credentials will be available once resources are deployed'})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-medium text-gray-900 flex items-center\",children:[/*#__PURE__*/_jsx(DocumentTextIcon,{className:\"h-5 w-5 mr-2\"}),\"Deployment History\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:logsLoading?/*#__PURE__*/_jsx(\"div\",{className:\"animate-pulse space-y-3\",children:[...Array(3)].map((_,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"h-16 bg-gray-200 rounded\"},i))}):deploymentLogs.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 text-center py-8\",children:\"No deployment history available\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:deploymentLogs.map(log=>/*#__PURE__*/_jsxs(\"div\",{className:\"border border-gray-200 rounded-lg p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:`px-2 py-1 text-xs rounded-full ${log.status==='completed'?'bg-success-100 text-success-800':log.status==='failed'?'bg-danger-100 text-danger-800':log.status==='running'?'bg-warning-100 text-warning-800':'bg-gray-100 text-gray-800'}`,children:log.action}),/*#__PURE__*/_jsx(\"span\",{className:`px-2 py-1 text-xs rounded-full ${log.status==='completed'?'bg-success-100 text-success-800':log.status==='failed'?'bg-danger-100 text-danger-800':log.status==='running'?'bg-warning-100 text-warning-800':'bg-gray-100 text-gray-800'}`,children:log.status})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:new Date(log.started_at).toLocaleString()})]}),log.error_message&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 p-2 bg-danger-50 border border-danger-200 rounded text-xs\",children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-danger-800\",children:\"Error:\"}),/*#__PURE__*/_jsx(\"pre\",{className:\"mt-1 text-danger-700 whitespace-pre-wrap\",children:log.error_message})]}),log.terraform_output&&/*#__PURE__*/_jsxs(\"details\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(\"summary\",{className:\"text-xs text-gray-600 cursor-pointer\",children:\"View Terraform Output\"}),/*#__PURE__*/_jsx(\"pre\",{className:\"mt-1 p-2 bg-gray-50 border rounded text-xs text-gray-700 whitespace-pre-wrap overflow-auto max-h-32\",children:log.terraform_output})]})]},log.id))})})]})]})]});};export default AttendeeView;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}