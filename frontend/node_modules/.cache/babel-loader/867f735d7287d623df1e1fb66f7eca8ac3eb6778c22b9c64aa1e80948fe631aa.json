{"ast":null,"code":"import React,{useState}from'react';import{ChevronDownIcon,ChevronUpIcon,DocumentTextIcon,XMarkIcon,CheckCircleIcon,ClockIcon}from'@heroicons/react/24/outline';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const DeploymentLogs=_ref=>{let{logs,isLoading=false}=_ref;const[isExpanded,setIsExpanded]=useState(false);const[expandedLogs,setExpandedLogs]=useState(new Set());const getStatusIcon=status=>{switch(status){case'completed':return/*#__PURE__*/_jsx(CheckCircleIcon,{className:\"h-4 w-4 text-success-500\"});case'failed':return/*#__PURE__*/_jsx(XMarkIcon,{className:\"h-4 w-4 text-danger-500\"});case'running':case'started':return/*#__PURE__*/_jsx(ClockIcon,{className:\"h-4 w-4 text-warning-500 animate-spin\"});default:return/*#__PURE__*/_jsx(ClockIcon,{className:\"h-4 w-4 text-gray-500\"});}};const getStatusColor=status=>{switch(status){case'completed':return'text-success-700 bg-success-50 border-success-200';case'failed':return'text-danger-700 bg-danger-50 border-danger-200';case'running':case'started':return'text-warning-700 bg-warning-50 border-warning-200';default:return'text-gray-700 bg-gray-50 border-gray-200';}};const toggleLogExpansion=logId=>{const newExpanded=new Set(expandedLogs);if(newExpanded.has(logId)){newExpanded.delete(logId);}else{newExpanded.add(logId);}setExpandedLogs(newExpanded);};const formatTimestamp=timestamp=>{if(!timestamp){return'N/A';}try{const date=new Date(timestamp);if(isNaN(date.getTime())){return'Invalid Date';}return date.toLocaleString();}catch(error){return'Invalid Date';}};const stripAnsiCodes=text=>{if(!text)return'';// Remove ANSI escape sequences\n// eslint-disable-next-line no-control-regex\nreturn text.replace(/\\x1b\\[[0-9;]*m/g,'');};if(isLoading){return/*#__PURE__*/_jsxs(\"div\",{className:\"animate-pulse\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-gray-200 rounded w-24 mb-2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-20 bg-gray-200 rounded\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setIsExpanded(!isExpanded),className:\"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors\",children:[/*#__PURE__*/_jsx(DocumentTextIcon,{className:\"h-4 w-4 mr-1\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Deployment Logs (\",logs.length,\")\"]}),isExpanded?/*#__PURE__*/_jsx(ChevronUpIcon,{className:\"h-4 w-4 ml-1\"}):/*#__PURE__*/_jsx(ChevronDownIcon,{className:\"h-4 w-4 ml-1\"})]}),isExpanded&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 space-y-2\",children:logs.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500 italic py-4 text-center\",children:isLoading?\"Loading deployment logs...\":\"No deployment logs available\"}):logs.map(log=>/*#__PURE__*/_jsxs(\"div\",{className:`border rounded-lg p-3 ${getStatusColor(log.status)}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[getStatusIcon(log.status),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium capitalize\",children:log.action}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs px-2 py-1 bg-white rounded\",children:log.status})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:formatTimestamp(log.started_at)})]}),log.error_message&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 p-2 bg-danger-100 border border-danger-300 rounded text-sm\",children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-danger-800\",children:\"Error:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-1 text-danger-700 font-mono text-xs whitespace-pre-wrap\",children:stripAnsiCodes(log.error_message)})]}),(log.terraform_output||log.error_message)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>toggleLogExpansion(log.id),className:\"text-xs text-gray-600 hover:text-gray-800 flex items-center\",children:expandedLogs.has(log.id)?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ChevronUpIcon,{className:\"h-3 w-3 mr-1\"}),\"Hide Details\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ChevronDownIcon,{className:\"h-3 w-3 mr-1\"}),\"Show Details\"]})}),expandedLogs.has(log.id)&&log.terraform_output&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 p-2 bg-gray-900 text-gray-100 rounded text-xs font-mono overflow-auto max-h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"whitespace-pre-wrap\",children:stripAnsiCodes(log.terraform_output)})})]})]},log.id))})]});};export default DeploymentLogs;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}